<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

  <title>formapi</title>
</head>

<body style="padding: 232px;">
<form id="forms">
  <div class="row">
    <div class=" col-12  col-sm-12 col-lg-6">
      <input type="text" name="id" id="id" placeholder=" id" class="form-control">

    </div>
    <div class=" col-12  col-sm-12 col-lg-6">
      <input type="text" name="firstname" id="firstname" placeholder=" First Name" class="form-control">

    </div>
    <div class=" col-12  col-sm-12 col-lg-6">

      <input type="text" name="scondname" id="scondname" placeholder=" Second Name" class="form-control">
    </div>
  </div>
  <div class="row">
    <div class=" col-12  col-sm-12 col-lg-6">


      <input type="number" name="phone" id="phone" placeholder="Mobile Number" class="form-control">
    </div>
    <div class=" col-12  col-sm-12 col-lg-6">
      <!-- <input type="email" placeholder="Email Id"> -->

      <input type="text" name="email" id="email" placeholder=" Email Id" class="form-control">

      <textarea class="form-control" name="messsages" id="messsages" placeholder="Messages"
        id="floatingTextarea2"></textarea>

    </div>
  </div>
  
  <button type="button" class="btn btn-primary" id="submitBtn" onclick="createuser()">Send Messages</button>
  <button type="button" class="btn btn-primary" id="updateBtn" onclick="update()">update</button>
  <button type="button" class="btn btn-primary" onclick="get()">get</button>
  
  </div>
</form>
  <table>
    <thead>
      <tr>
        <th>id</th>
        <th>firstname</th>
        <th>scondname</th>
        <th>phone</th>
        <th>email</th>
        <th>messsages</th>



      </tr>
    </thead>
    <tbody>

    </tbody>

<script>
let form=document.getElementById('forms')
  function createuser() {
   
 document.getElementById('userForm').reset()
    fetch('http://localhost:3000/post', {
      method: 'POST',
      body: JSON.stringify({

        firstname: document.getElementById("firstname").value,
        scondname: document.getElementById("scondname").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        messsages: document.getElementById("messsages").value,
      }),
      headers: {
        'Content-type': 'application/json; charset=UTF-8',
      },
    })
      .then((response) => response.json())
      .then((json) => console.log(json));
      form.reset();
  }

  function edit(id) {
    document.getElementById('updateBtn').style.display="block";
document.getElementById('submitBtn').style.display="none";


    fetch('http://localhost:3000/'+id)
      .then((response) => response.json())
      .then((json) => {console.log(json)
        json.forEach(e=>{
          console.log(e,'fghj')
          // let{}=e[0]
          document.getElementById("id").value=e.id,
         document.getElementById("firstname").value=e.firstname,
        document.getElementById("scondname").value=e.scondname,
      document.getElementById("phone").value=e.phone,
         document.getElementById("email").value=e.email,
       document.getElementById("messsages").value =e.messsages
       document.getElementById('form-btn').textContent = "Update";

        })
  });
  
  }
 


  // function edit(id) {
  //   fetch('http://localhost:3000/'+id)
  //     .then((response) => response.json())
  //     .then((json) => {console.log(json)
  //       json.forEach(e=>{
  //         console.log(e,'fghj')
  //         // let{}=e[0]
  //         document.getElementById("id").value=e.id,
  //        document.getElementById("firstname").value=e.firstname,
  //       document.getElementById("scondname").value=e.scondname,
  //     document.getElementById("phone").value=e.phone,
  //        document.getElementById("email").value=e.email,
  //      document.getElementById("messsages").value =e.messsages
  //       })
  // });
  // }

 
// function Get(){
  
//    console.log(uid,"vgggggg")
//   fetch( 'http://localhost:3000/GET', {
//         method: 'PUT',
//         body: JSON.stringify({
          
//          firstname:document.getElementById("firstname").value,
//          scondname: document.getElementById("scondname").value,
//          phone: document.getElementById("phone").value,
//          email: document.getElementById("email").value,
//          messsages: document.getElementById("messsages").value,
//         }),
//         headers: {
//           'Content-type': 'application/json; charset=UTF-8',
//         },
//       })
//         .then((response) => response.json())
//         .then((json) => console.log(json));
      
//     }

function update(){
  // document.getElementById('submitBtn').style.display="none";
  //   document.getElementById('updateBtn').style.display="block";
  
   let uid=document.getElementById("id").value;
   console.log(uid,"vgggggg")
  fetch('http://localhost:3000/upadte/'+ uid, {
        method: 'PUT',
        body: JSON.stringify({
          
         firstname:document.getElementById("firstname").value,
         scondname: document.getElementById("scondname").value,
         phone: document.getElementById("phone").value,
         email: document.getElementById("email").value,
         messsages: document.getElementById("messsages").value,
        }),
        headers: {
          'Content-type': 'application/json; charset=UTF-8',
        },
      })
        .then((response) => response.json())
        .then((json) => console.log(json));
        form.reset();
    }

  function get(){
    document.getElementById('updateBtn').style.display="none";
document.getElementById('submitBtn').style.display="block";
document.getElementById('forms').reset()

  fetch('http://localhost:3000/GET')
    .then(res => res.json())
    .then(user => {

      console.log(user)

      html = ""

      user.forEach(e => {html += `<tr>
          <td>${e.id}</td>
 <td>${e.firstname}</td>
 <td>${e.scondname}</td>
 <td>${e.phone}</td>
 <td>${e.email}</td>
 <td>${e.messsages}</td>
 <td><button type="button" class="btn btn-primary" onclick="edit(${e.id})">Edit</button></td>
 

 </tr>`

      });

      console.log(html)

      document.getElementsByTagName("tbody")[0].innerHTML = html
    }).catch((err) => {
      console.log('DDD', err)
    })
  }
  
</script>

</body>
</html>